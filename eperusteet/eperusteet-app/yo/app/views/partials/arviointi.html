<!--
Copyright (c) 2013 The Finnish Board of Education - Opetushallitus

This program is free software: Licensed under the EUPL, Version 1.1 or - as
soon as they will be approved by the European Commission - subsequent versions
of the EUPL (the "Licence");

You may not use this work except in compliance with the Licence.
You may obtain a copy of the Licence at: http://ec.europa.eu/idabc/eupl

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
European Union Public Licence for more details.
-->

<div class="panel panel-default panel-small" ng-repeat="kohdealue in arviointi.arvioinninKohdealueet">
  <div class="panel-heading">
    <h3 class="panel-title">
      <arvioinnin-tekstikentta sisalto="kohdealue" sisaltoteksti="kohdealue.otsikko" sisaltoalue="$parent.arviointi.arvioinninKohdealueet" edit-allowed="editAllowed"/>
    </h3>
  </div>
  <div class="panel-body">
    <accordion close-others="false">
      <accordion-group heading="{{valitseKieli(arvioinninkohde.otsikko)}}" ng-repeat="arvioinninkohde in kohdealue.arvioinninKohteet">
        <accordion-heading>
          <arvioinnin-tekstikentta clickable="true" sisalto="arvioinninkohde" sisaltoteksti="arvioinninkohde.otsikko" sisaltoalue="$parent.kohdealue.arvioinninKohteet" edit-allowed="editAllowed"/>
        </accordion-heading>
        <div ng-repeat="taso in arviointiasteikot[arvioinninkohde._arviointiAsteikko].osaamistasot" ng-class-odd="'raita'" ng-class-even="'ei-raitaa'">
          <div class="row">
            <div class="col-md-3">
              {{valitseKieli(taso.otsikko)}}
            </div>
            <div class="col-md-9">
              <div class="panel kriteeri" ng-repeat="osaamistasonKriteeri in arvioinninkohde.osaamistasonKriteerit | filter:{_osaamistaso: taso.id}">
                <ul class="list-group">
                  <li class="list-group-item" ng-repeat="kriteeri in osaamistasonKriteeri.kriteerit">
                    <arvioinnin-tekstikentta sisalto="kriteeri" sisaltoalue="$parent.osaamistasonKriteeri.kriteerit" edit-allowed="editAllowed"/>
                  </li>
                </ul>
                <div class="panel-footer" ng-if="editAllowed">
                  <input editointi-kontrolli class="form-control" ng-show="uudenKriteerinTiedot.showInput" type="text" ng-model="uudenKriteerinTiedot.teksti" 
                    on-enter="addNewKriteeri($parent.osaamistasonKriteeri, uudenKriteerinTiedot)" 
                    placeholder="{{'arviointi-uusi-kriteeri-placeholder' | translate}}"/>
                  <button editointi-kontrolli type="button" class="btn btn-default btn-xs" ng-show="!uudenKriteerinTiedot.showInput" 
                    ng-click="uudenKriteerinTiedot.showInput = true">{{'arviointi-uusi-kriteeri' | translate}}&nbsp;&nbsp;<span class="glyphicon glyphicon-plus"></span></button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </accordion-group>
    </accordion>
    <div class="panel panel-default" ng-if="editAllowed">
      <div class="panel-body">
        <div ng-show="uudenKohteenTiedot.showInputArea">
          <input editointi-kontrolli class="form-control" type="text" ng-model="uudenKohteenTiedot.nimi" placeholder="{{'arviointi-uusi-kohde-placeholder' | translate}}"/><br/>
          <label translate>arviointi-asteikon-valinta</label><br/>
          <input editointi-kontrolli type="radio" ng-model="uudenKohteenTiedot.arviointiasteikko" ng-repeat-start="arviointiasteikko in arviointiasteikot" ng-value="arviointiasteikko" />
          <span ng-repeat="osaamistaso in arviointiasteikko.osaamistasot">{{valitseKieli(osaamistaso.otsikko)}}{{$index + 1 !== arviointiasteikko.osaamistasot.length ? '&nbsp;/&nbsp;': ''}}</span>
          <br ng-repeat-end/>
          <button class="btn btn-default btn-xs" editointi-kontrolli ng-disabled="!(uudenKohteenTiedot.nimi && uudenKohteenTiedot.arviointiasteikko)" ng-click="addNewKohde($parent.kohdealue, uudenKohteenTiedot);" translate>ok</button>
          <button class="btn btn-default btn-xs" ng-click="closeNewKohde(uudenKohteenTiedot)" translate>peru</button>
        </div>
        <button editointi-kontrolli type="button" class="btn btn-default btn-xs" ng-show="!uudenKohteenTiedot.showInputArea" 
          ng-click="uudenKohteenTiedot.showInputArea = true">{{'arviointi-uusi-kohde' | translate}}&nbsp;&nbsp;<span class="glyphicon glyphicon-plus"></span></button>
      </div>
    </div>
  </div>
</div>
<div class="panel panel-default" ng-if="editAllowed">
  <div class="panel-body">
    <input editointi-kontrolli class="form-control" ng-show="$parent.showNewKohdealueInput" type="text" ng-model="$parent.uudenKohdealueenNimi" on-enter="$parent.addNewKohdealue()" 
    placeholder="{{'arviointi-uusi-kohdealue-placeholder' | translate}}"/>
    <button editointi-kontrolli type="button" class="btn btn-default btn-xs" ng-show="!$parent.showNewKohdealueInput" 
      ng-click="$parent.showNewKohdealueInput = !$parent.showNewKohdealueInput">{{'arviointi-uusi-kohdealue' | translate}}&nbsp;&nbsp;<span class="glyphicon glyphicon-plus"></span></button>
  </div>
</div>
