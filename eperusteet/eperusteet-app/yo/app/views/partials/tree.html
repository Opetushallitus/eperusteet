<div>
  <div class="muodostumisvivut">
    <a href="" ng-click="suljePolut()">
      <span ng-show="suljettuViimeksi" class="glyphicon glyphicon-chevron-down"></span>
      <span ng-hide="suljettuViimeksi" class="glyphicon glyphicon-chevron-up"></span>
      Avaa / Sulje kaikki
    </a>
  </div>
  <div ng-if="lisataanUuttaOsaa">
    <muokkaus-tutkinnonosa tutkinnon-osa="uusiOsa"></muokkaus-tutkinnonosa>
  </div>
  <div class="tree-presentation">
    <h2>{{ rakenne.rakenne.otsikko.fi }}</h2>
    <hr></hr>
    <div ng-if="!lisataanUuttaOsaa" class="tree">
      <tree muokkaus="muokkaus" ng-if="rakenne.$resolved" rakenne="rakenne.rakenne" tutkinnon-osat="rakenne.tutkinnonOsat" uusi-tutkinnon-osa="uusiTutkinnonOsa"></tree>
    </div>
    <div ng-if="muokkaus" class="skratchpadlist">
      <tabset justified="true">
        <tab heading="Leikelauta">
          <div class="skratchpad-items">
            <div ui-sortable="sortableOptions" class="tree-group skratchpad" ng-model="skratchpad">
              <div class="skratchpad-item" ng-class="{ 'skratchpad-item-virhe': osa.$virhe }" ng-repeat="osa in skratchpad">
                <div ng-if="osa._tutkinnonOsa">{{ rakenne.tutkinnonOsat[osa._tutkinnonOsa].nimi.fi }}</div>
                <div ng-if="!osa._tutkinnonOsa && osa.otsikko">{{ osa.otsikko.fi }}</div>
                <div ng-if="osa.osat !== undefined">
                  <span>
                    Ryhmä ({{ osa.osat.length }} osaa)
                    <a class="pull-right" href="" ng-click="ryhmaModaali(osa)"><span class="glyphicon glyphicon-pencil"></span> Muokkaa</a>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </tab>
        <tab heading="Osat">
          <div class="skratchpad-items">
            <div class="skratchpad-item" ng-repeat="(key, value) in rakenne.tutkinnonOsat">{{ value.nimi.fi }}</div>
          </div>
        </tab>
      </tabset>
      <div class="skratchpad-footer">
        <button class="btn btn-default skratchpad-btn" ng-click="ryhmaModaali()"><span class="glyphicon glyphicon-plus"></span> Uusi ryhmä</button>
        <button class="btn btn-default skratchpad-btn" ng-click="tuoTutkinnonosa()"><span class="glyphicon glyphicon-plus"></span> Tuo tutkinnon osa</button>
        <button class="btn btn-default skratchpad-btn" ng-click="uusiTutkinnonOsa()" disabled><span class="glyphicon glyphicon-plus"></span> Uusi tutkinnon osa</button>
      </div>
    </div>
  </div>
</div>
